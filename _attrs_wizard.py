import pandas as pd

# Загрузка Excel-файла
df = pd.read_excel("Ваш_файл_с_данными.xlsx")

# Порядок колонок, как они должны быть в финальной строке
columns = [
    "Тип установки",
    "Высота",
    "Ширина",
    "Глубина",
    "Количество камер",
    "Количество дверей",
    "Общий объем",
    "Объем морозильной камеры",
    "Цвет",
    "Расположение морозильной камеры",
    "Объем холодильной камеры",
    "Класс энергопотребления",
    "Размораживание морозильной камеры",
    "Размораживание холодильной камеры",
    "Дисплей",
    "Генератор льда",
    "Зона свежести"
]

# Префиксы
prefixes = {
    "Тип установки": "Общие характеристики:",
    "Высота": "Габариты и объем:",
    "Ширина": "Габариты и объем:",
    "Глубина": "Габариты и объем:",
    "Количество камер": "Характеристики холодильника:",
    "Количество дверей": "Характеристики холодильника:",
    "Общий объем": "Габариты и объем:",
    "Объем морозильной камеры": "Габариты и объем:",
    "Цвет": "Общие характеристики:",
    "Расположение морозильной камеры": "Характеристики холодильника:",
    "Объем холодильной камеры": "Габариты и объем:",
    "Класс энергопотребления": "Общие характеристики:",
    "Размораживание морозильной камеры": "Характеристики холодильника:",
    "Размораживание холодильной камеры": "Характеристики холодильника:",
    "Дисплей": "Общие характеристики:",
    "Генератор льда": "Характеристики холодильника:",
    "Зона свежести": "Характеристики холодильника:"
}

# Функция формирования строки
def combine_row(row):
    parts = []
    for col in columns:
        value = row[col]
        if pd.notna(value):
            # Преобразование 1.0 → 1
            if isinstance(value, float) and value.is_integer():
                value = int(value)
            # Добавляем префикс перед каждой характеристикой
            prefix = prefixes.get(col, "")
            parts.append(f"{prefix}{col}:{value}")

    return "|".join(parts)

# Применение
df["Объединённые данные"] = df.apply(combine_row, axis=1)

# Генерация безопасного имени с хэшем (на основе времени)
timestamp = str(time.time()).encode("utf-8")
hash_suffix = hashlib.md5(timestamp).hexdigest()[:8]
filename = f"coldbox_html_tables_{hash_suffix}.xlsx"

# Сохранение
df[["Объединённые данные"]].to_excel("обработанный_файл.xlsx", index=False)
